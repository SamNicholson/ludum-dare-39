<!DOCTYPE html>
<html>
<head>
    <title>Ludum Dare 39</title>
    <!-- Libraries -->
    <script type="text/javascript" src="js/libs/create.js"></script>
    <script type="text/javascript" src="js/libs/creatine.js"></script>
    <script type="text/javascript" src="js/libs/jquery.js"></script>

    <!-- Game Assets -->
    <script type="text/javascript" src="js/robot_handler.js"></script>
    <script type="text/javascript" src="js/collectible.js"></script>
    <script type="text/javascript" src="js/collectible_handler.js"></script>


    <style type="text/css">
        #container {
        }
    </style>
</head>
<script type="application/javascript">

    tine.DEFAULT_CONFIG.container = 'game';
    tine.DEFAULT_CONFIG.width = 1024;
    tine.DEFAULT_CONFIG.height = 576;

    POWER_DEGRADE = -0.025;

    COLLECTIBLE_SPEED = 1.5;
    COLLECTIBLE_MAX = 10;
    COLLECTIBLE_SPAWN_INTERVAL = 1;
    COLLECTIBLE_SPAWN_CHANCE = 0.01;
    GAME_TIME = 0;
    GAME_START_TIME = new Date();

    $(function(){

        var domFps = $('#game-fps');
        // var domTick = $('#game-tick');

        setInterval(function() {
            domFps.html(Math.round(createjs.Ticker.getMeasuredFPS()));
        }, 100);

        var game = new tine.Game(null, {
            preload: function() {
                game.load.image('robot', 'sprites/spaceship_red_base1.png');
                game.load.image('collectible', 'images/sample_collectable.png');
            },

            create: function() {

                //TODO - we can add multiplayer functionality in here - initialise more robots and get them to move
                game.robots = [];
                game.robots.push(new Robot([512, 526], 'robot', game));
                game.collectibleHandler = new CollectibleHandler(game);

            },

            update: function() {

                $.each(game.robots, function(key, robot) {
                    robot.update(game);
                });
                game.collectibleHandler.update(game);

                //Handle updating the game time
                GAME_TIME = (new Date() - GAME_START_TIME)/1000;
            }
        });

        game.end = function() {
            if (!game.hasEnded) {
                alert('game over');
                game.hasEnded = true;
            }
        }



    });
</script>
<body onload="">
    <div id="container">
        <div id="game" width="1000px" height="600px"></div>
        <div id="place-holder">
            <div class="bg-dark gameview">
                <p class="uk-padding-left" style="padding-bottom:2px">FPS: <span id="game-fps">Constant</span></p>
        </div>
    </div>
<script>
</script>
</body>
</html>